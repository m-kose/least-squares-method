WIP, need some polishing and error handling.
